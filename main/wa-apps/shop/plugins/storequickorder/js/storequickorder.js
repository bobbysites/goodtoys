(function(c){sCenterDialog=function(a){a=c(a);a=a.find(".dialog-window");var b=a.outerWidth(!0);a.outerHeight(!0);var e=c(window).width();c(window).height();b=e/2-b/2;void 0!==c.storequickorder.options.window_vert_align&&c.storequickorder.options.window_vert_align?a.css({marginLeft:Math.round(b)+"px",marginTop:c(window).scrollTop()+c.storequickorder.options.window_margin_top+"px",position:"absolute"}):a.css({marginLeft:Math.round(b)+"px",marginTop:c.storequickorder.options.window_margin_top+"px"})};sdialogCreate=function(a){a=c.extend({url:null,post:null,el:null},a);var b=c("#storequickorder");if(0>=b.size()){if(a.url){var e=function(d){b=c(d);"function"==typeof storequickorder_event_dialog_show?storequickorder_event_dialog_show(d,b,a):(b.appendTo("body"),b.show());a.el.removeAttr("disabled");sCenterDialog(b);c("#storequickorder").on("click",".close-button",function(){c("input[name=storequickorder_result_success]").length?("function"==typeof storequickorder_event_dialog_result_success&&storequickorder_event_dialog_result_success(d,b,a),c("#storequickorder").remove(),location.reload()):c("#storequickorder").remove()});c("#storequickorder").on("click",".submit-button",function(){var e=this;"function"==typeof storequickorder_event_dialog_submit&&storequickorder_event_dialog_submit(d,b,e);if(c("#storequickorder form:first").length){var f=c("#storequickorder form:first"),h="frontend_cart"==c(f).find('input[name="place"]').val()?"cart_order":"order";c.ajax({url:a.el.attr("data-app-url")+"storequickorder/"+h+"/",data:c(f).serialize(),type:"POST",dataType:"html",beforeSend:function(){"function"==typeof storequickorder_event_dialog_submit_beforesend&&storequickorder_event_dialog_submit_beforesend(d,b,e);c(e).attr("disabled","disabled")},success:function(a){"function"==typeof storequickorder_event_dialog_submit_success&&storequickorder_event_dialog_submit_success(c.storequickorder.options,a);c("#storequickorder .dialog-content-indent").replaceWith(c(a).find(".dialog-content-indent"));c(a).find(".checkout-result").length?(void 0===c.storequickorder.options.yaCounter_enabled||1!=c.storequickorder.options.yaCounter_enabled||void 0===c.storequickorder.options.yaCounter_id||isNaN(parseInt(c.storequickorder.options.yaCounter_id))||"object"!=typeof eval("yaCounter"+c.storequickorder.options.yaCounter_id)||eval("yaCounter"+c.storequickorder.options.yaCounter_id).reachGoal(c.storequickorder.options.yaCounter_target_name),void 0!==c.storequickorder.options.ga_enabled&&1==c.storequickorder.options.ga_enabled&&void 0!==c.storequickorder.options.ga_id&&"function"==typeof ga&&ga("send","event",c.storequickorder.options.ga_target_name,c.storequickorder.options.ga_target_name),"function"==typeof storequickorder_event_order_created&&storequickorder_event_order_created(c.storequickorder.options,a),c(e).hide()):c(e).removeAttr("disabled","disabled")}})}});var e=function(d){if(b.is(":visible"))if(d&&27==d.keyCode)a.oncancel&&"function"==typeof a.oncancel&&a.oncancel.call(b[0]),c("#storequickorder").remove();else c(document).one("keyup",e)};e();a.onload&&a.onload.call(b[0])};a.post?c.post(a.url,a.post,e):c.get(a.url,e)}}else b.show();c(document).one("hashchange",c("#storequickorder").remove);return b};c(function(){c.storequickorder={init:0,is_mobile:!0,options:{},check_stock_delay:100,setOptions:function(a){this.options=a;"undefined"!=typeof a.check_stock_delay&&(this.check_stock_delay=a.check_stock_delay);/iPhone/i.test(window.navigator.userAgent)&&(this.is_mobile=!0);/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)&&(this.is_mobile=!0);this.options.window_margin_top=200;"undefined"!=typeof a.window_margin_top&&a.window_margin_top&&(this.options.window_margin_top=200)},findParentFormBuyoneclick:function(a){var b,e,d;if((b=a.closest("form"))&&b.length)return b;if((e=a.closest("li"))&&e.length){if((b=e.find("form").first())&&b.length)return b}else if((d=a.closest("div.cart"))&&d.length){if((b=d.find("form").first())&&b.length)return b}else if((b=c("form#cart-form").first())&&b.length||(b=c("form.cart-form"))&&1==b.length)return b;return c()},initProduct:function(a){1!=this.init&&(c("#dsvoverview").removeAttr("tabindex"),this.init=1);if("undefined"==typeof a.button_id)return!1;a.place="product";this.initButtonBuyoneclick(a)},initFrontendCart:function(a){if("undefined"==typeof a.button_id)return!1;a.place="frontend_cart";this.initButtonBuyoneclick(a)},initButtonBuyoneclick:function(a){var b=this;1!=b.init&&(c("#dsvoverview").removeAttr("tabindex"),b.init=1);if("undefined"==typeof a.button_id)return!1;var e=a.button_id,d=c("."+e),f=b.findParentFormBuyoneclick(d);f.data("storequickorder-button",d);d.data("parent_form",f);"undefined"!=typeof a.place?d.data("place",a.place):d.data("place","product");"function"==typeof storequickorder_event_init_buyoneclick&&storequickorder_event_init_buyoneclick(a,d);var g="order";"frontend_cart"==d.data("place")?g="cart_order":f.find('[name="product_id"]').length||d.hide();c("body").on("click","."+e,function(){var a=c(this);"function"==typeof storequickorder_event_button_click&&storequickorder_event_button_click(a,f,e);a.attr("disabled","disabled");sdialogCreate({url:a.attr("data-app-url")+"storequickorder/"+g+"/",post:f.serialize()+"&product_data=1",el:a})});b.searchMethodStorageStocks(d,f);f.find("#product-skus input:radio").on("click",function(){c(this).data("disabled")?b.setVisibilityButton(!1,d,f):b.setVisibilityButton(!0,d,f)});f.find(".skus input:radio,.services input[type=checkbox],.inline-select a,a[data-feature-id]").on("click",function(){setTimeout(function(){b.checkStock(d,f)},b.check_stock_delay)});f.find('select.sku-feature,select[name^="service_variant"]').on("change",function(){setTimeout(function(){b.checkStock(d,f)},b.check_stock_delay)});b.checkStock(d,f);setTimeout(function(){b.checkStock(d,f)},b.check_stock_delay)},checkStock:function(a,b){var e=!0;if("div_stocks"==a.data("methodStorageStock")){var d=!1;b.find('div.stocks strong[class^="stock-"]:visible, div.stocks span[class^="stock-"]:visible').each(function(a,b){c(this).hasClass("stock-none")?e=!1:d=!0});e=d?!0:!1}else if("div_stocks_custom"==a.data("methodStorageStock")||"default"==a.data("methodStorageStock"))e=this.isEnabledAdd2cart_button(a,b);this.setVisibilityButton(e,a,b);"function"==typeof storequickorder_event_check_stock&&storequickorder_event_check_stock(e,a,b);return e},searchMethodStorageStocks:function(a,b){if("function"==typeof storequickorder_event_search_method)return storequickorder_event_search_method(a,b,this);if("undefined"==typeof a.data("methodStorageStock")||""==a.data("methodStorageStock"))b.find("div.stocks strong").length?(a.data("methodStorageStock","div_stocks"),b.find("div.stocks strong:visible").length||a.data("methodStorageStock","div_stocks_custom")):b.find("div.stocks span").length?(a.data("methodStorageStock","div_stocks"),b.find("div.stocks span:visible").length||a.data("methodStorageStock","div_stocks_custom")):a.data("methodStorageStock","default");return a.data("methodStorageStock")},setVisibilityButton:function(a,b,c){if("function"==typeof storequickorder_event_set_visibility_button)return storequickorder_event_set_visibility_button(a,b,c,this);"frontend_cart"!=b.data("place")&&(a?void 0!==this.options.button_name&&b.val(this.options.button_name):void 0!==this.options.button_name_not_available&&b.val(this.options.button_name_not_available));void 0!==this.options.always_show_active_button&&this.options.always_show_active_button||a?(b.removeAttr("disabled"),"function"==typeof storequickorder_event_set_visibility_button_true&&storequickorder_event_set_visibility_button_true(a,b,c)):(b.attr("disabled","disabled"),"function"==typeof storequickorder_event_set_visibility_button_false&&storequickorder_event_set_visibility_button_false(a,b,c))},isEnabledAdd2cart_button:function(a,b){return"function"==typeof storequickorder_event_is_enabled_add2cart?storequickorder_event_is_enabled_add2cart(a,b):!b.find('.add2cart [type="submit"]').is("[disabled]")||0<b.find('.add2cart [type="submit"]:enabled').length?!0:!1},startCheckStock:function(a,b){this.checkStock(a,b)}}})})(jQuery);